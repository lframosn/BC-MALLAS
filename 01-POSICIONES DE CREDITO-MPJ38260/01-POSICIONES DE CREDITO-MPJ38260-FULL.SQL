--- creacion de grupo de usuarios SAT
IF NOT EXISTS (SELECT 1 FROM DBO.SYSUSERS WHERE name = 'SAT')
BEGIN
CREATE USER SAT 
FORCE PASSWORD CHANGE OFF;
END;
COMMIT;

--- creacion de grupo de usuarios SAT
IF NOT EXISTS (SELECT 1 FROM DBO.SYSUSERS WHERE name = 'STG_SAT')
BEGIN
CREATE USER STG_SAT 
FORCE PASSWORD CHANGE OFF;
END;
COMMIT;

----------------------------------------------------
-- INTERFAZ POSICIONES DE CREDITO
----------------------------------------------------
--CU – CUENTA DE MEDIOS DE PAGO - TABLA PCENVP01_CU
--LI – LINEAS ASOCIADAS A LA CUENTA - TABLA PCENVP01_LI
--MP – MEDIO DE PAGO (TARJETA) - TABLA PCENVP01_MP
--IC – CONTRATO IMPAGADO - TABLA PCENVP01_IC
--IL – DESGLOSE CONTRATO IMPAGADO - TABLA PCENVP01_IL
--RI – RECIBO IMPAGADO - TABLA PCENVP01_RI
--RL – DESGLOSE RECIBO IMPAGADO - TABLA PCENVP01_RL
--MI – MOVIMIENTO RECIBO IMPAGADO - TABLA PCENVP01_MI
--CI – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO - TABLA PCENVP01_CI
--PU – PUNTOS - TABLA PCENVP01_PU

drop table IF EXISTS SAT.PCENVPO1_CI;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_CI  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMSECIMP	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO IMPAGADO
,	NUMMOVIMP	DECIMAL	(7,0)	--NUMERO DE MOVIMIENTO DEL RECIBO IMPAGADO
,	CODCONECO	DECIMAL	(4,0)	--CODIGO DE CONCEPTO ECONOMICO
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE
---        02 – COMISIONES	 	 		
---        03 – INTERESES	 	 		
---        04 – IMPUESTOS	 	 		
---        05 – COMISIONES MOROSIDAD	 	 		
---        06 – INTERESES MOROSIDAD	 	 		
---        07 – IMPUESTOS MOROSIDAD	 	 		
---        08- SEGURO	 	 		
,	IMPAPLECO	DECIMAL	(17,2)	--IMPORTE SOBRE EL QUE SE APLICA EL CONCEPTO ECONOMICO
,	IMPBRUECO	DECIMAL	(17,2)	--IMPORTE BRUTO CALCULADO POR EL CONCEPTO ECONOMICO
,	IMPBONECO	DECIMAL	(17,2)	--IMPORTE DE BONIFICACION CALCULADO POR EL CONCEPTO ECONOMICO
,	IMPIMPTO	DECIMAL	(17,2)	--IMPORTE DEL IMPUESTO
,	IMPCONSOL	DECIMAL	(17,2)	--IMPORTE CONSOLIDADO
,	PORINT	DECIMAL	(7,4)	--PORCENTAJE DE INTERES APLICADO
,	INDPERCON	VARCHAR	(1)	--INDICADOR DE CONCEPTO PERDONADO
,	FILLER1	VARCHAR	(725)	--
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_CU;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_CU  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	FECULTCAR	DATE		--FECHA ULTIMO CARGO O PAGO
,	PRODUCTO	VARCHAR	(2)	--CODIGO DE PRODUCTO
,	SUBPRODU	VARCHAR	(4)	--CODIGO DE SUBPRODUCTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	LIMCRECTA	DECIMAL	(17,2)	--LIMITE DE CREDITO CUENTA TARJETA
,	LIMCRECTATEM	DECIMAL	(17,2)	--LIMITE DE CREDITO CUENTA TARJETA. TEMPORAL
,	FECINITEM	DATE		--INICIO VIGENCIA DE LIMITES TEMPORALES
,	FECFINTEM	DATE		--FIN VIGENCIA DE LIMITES TEMPORALES
,	SALAUTCRE	DECIMAL	(17,2)	--SALDO DE CREDITO AUTORIZADO
,	SALDISCRE	DECIMAL	(17,2)	--SALDO DE CREDITO DISPUESTO
,	LIMCRECTAC	DECIMAL	(17,2)	--LIMITE DE CREDITO COMPRA EN CUOTAS
,	SALAUTCREC	DECIMAL	(17,2)	--SALDO DE COMPRA EN CUOTAS AUTORIZADO
,	SALDISCREC	DECIMAL	(17,2)	--SALDO DE COMPRA EN CUOTAS DISPUESTO
,	FECPROVEN	DATE		--FECHA DE PROXIMO VENCIMIENTO
,	FECULTVEN	DATE		--FECHA DE ULTIMO VENCIMIENTO
,	FECRESOL	DATE		--FECHA DE RESOLUCION DEL CONTRATO
,	IDENTCLI	VARCHAR	(8)	--IDENTIFICADOR DEL CLIENTE
,	CODESTCTA	DECIMAL	(2,0)	--CODIGO DE ESTADO DEL CONTRATO DE TARJETA
---        00 – OPERATIVO 	 	 		
---        01 – IMPAGADO LEVE	 	 		
---        02 – IMPAGADO GRAVE	 	 		
---        03 – IMPAGADO DEFINITIVO	 	 		
,	FECULTESTCTA	DATE		--FECHA ULTIMO CAMBIO DE ESTADO DEL CONTRATO DE TARJETA
,	CODCONVEN	VARCHAR	(4)	--CODIGO DE CONVENIO
,	INDCTAEMP	DECIMAL	(1,0)	--INDICADOR DE CUENTA DE EMPRESA
,	INDDOMCARCRE	VARCHAR	(1)	--INDICADOR DE DOMICILIACION DEL CARGO DEL EXTRACTO DE CREDITO
,	IBAN	VARCHAR	(4)	--IBAN DE LA CUENTA DE CARGO
,	CTACARGO	VARCHAR	(30)	--CUENTA DE CARGO O DOMICILIACION
,	FORPAGO	DECIMAL	(2,0)	--FORMA DE PAGO DEL EXTRACTO DE CREDITO
---        01 – PAGO TOTAL (SOLO SI EXISTE CUENTA DE DOMICILIACION)	 	 		
---        02 – FIJO (SOLO SI EXISTE CUENTA DE DOMICILIACION)	 	 		
---        03 – PAGO MINIMO O APLAZADO	 	 		
,	INDSITCTA	DECIMAL	(1,0)	--INDICADOR DE SITUACION DEL CONTRATO
---        0 – ACTIVO 	 	 		
---        1 – EN ESPERA RESOLUCION. NO EMITIDA LA TARJETA	 	 		
---        2 – NO RESUELTA	 	 		
---        3 – EN ESPERA DE CONFIRMAR POR CLIENTE. TARJETA EMITIDA	 	 		
---        4 – ALTA DE CONTRATO SIN TARJETA	 	 		
,	COMISIONES	DECIMAL	(17,2)	--DEUDA EN COMISIONES A PASO DE MALLA
,	INTERESES	DECIMAL	(17,2)	--DEUDA EN INTERESES A PASO DE MALLA
,	CAPITAL	DECIMAL	(17,2)	--DEUDA EN CAPITAL A PASO DE MALLA
,	GRUPOLIQ	DECIMAL	(2,0)	--GRUPO DE LIQUIDACION
,	CODBLQULT	DECIMAL	(2,0)	--CODIGO DE BLOQUEO CON MAS PESO Y MAS RECIENTE
,	IMPMINORIGINAL	DECIMAL	(17,2)	--IMPORTE MINIMO ORIGINAL
,	IMPMINPENDIENTE	DECIMAL	(17,2)	--IMPORTE MINIMO PENDIENTE
,	MOTBLQ	DECIMAL	(2,0)	--MOTIVO DE BLOQUEO
,	FILLER1	VARCHAR	(142)	--ESPACIO DISPONIBLE DEL REGISTRO
,	CODVIAJFRE 	VARCHAR	(25)	--COdigo de viajero frecuente 
,	FECALTAVIAJ	VARCHAR	(10)	--Fecha de alta cOdigo de viajero frecuente 
,	INDCLICUMM 	VARCHAR	(1)	--Indicador cliente cumplido para mora 
--N  	 	 		
--S 	 	 		
,	INDCLICUMC 	VARCHAR	(1)	--Indicador de cliente cumplido para consumos 
--N – No Cumple 	 	 		
--C – Cliente cumplidor 	 	 		
--M – Cliente medio cumplidor 	 	 		
,	FECCLICUM  	VARCHAR	(10)	--Fecha Ultima actualizaciOn cliente cumplido 
,	CLASIFRISAT	VARCHAR	(2)	--ClasificaciOn de riesgo SAT 
,	CLASIFRIREG	VARCHAR	(2)	--ClasificaciOn de riesgo regulatorios 
,	CLASIFRIMDE	VARCHAR	(2)	--ClasificaciOn de riesgo motor de decisiOn 
,	TASAEFECMAX	DECIMAL	(7,4)	--Tasa efectiva mAxima 
,	FILLER2	VARCHAR	(3)	--
,	FILLER3	VARCHAR	(299)	--
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_IC;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_IC  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	CLAMON	DECIMAL	(3,0)	--MONEDA
,	SITUACION	DECIMAL	(2,0)	--SITUACION DEL CONTRATO IMPAGADO
,	IMPCONT	DECIMAL	(17,2)	--IMPORTE TOTAL DE IMPAGO DEL CONTRATO
,	IMPAGO	DECIMAL	(17,2)	--IMPORTE TOTAL EN IMPAGO, INCLUYE INTERESES Y COMISIONES DE MORA
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO (COBRADO)
,	FECULTAPL	DATE		--FECHA DE ULTIMA APLICACION
,	FECENVCOB	DATE		--FECHA DE ENVIO A LA APLICACION DE COBRANZAS
,	FILLER1	VARCHAR	(770)	--
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_IL;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_IL  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	CLAMON	DECIMAL	(3,0)	--MONEDA
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE
---        01 – CAPITAL	 	 		
---        02 – COMISIONES	 	 		
---        03 – INTERESES	 	 		
---        04 - IMPUESTOS	 	 		
---        05 – COMISIONES MOROSIDAD	 	 		
---        06 – INTERESES MOROSIDAD	 	 		
---        07 – IMPUESTOS MOROSIDAD	 	 		
---        08- SEGURIDAD	 	 		
,	IMPORTE	DECIMAL	(17,2)	--IMPORTE CORRESPONDIENTE AL TIPO DE IMPORTE
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO AL TIPO DE IMPORTE
,	FILLER1	VARCHAR	(803)	--
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_LI;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_LI  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	LINREF	DECIMAL	(8,0)	--REFERENCIA DE LINEA ASOCIADA A LA CUENTA
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA 
,	CODCAMCOM	VARCHAR	(4)	--CODIGO DE CAMPANA A LA CUAL ESTA ASOCIADA LA LINEA
,	CLAMON	DECIMAL	(3,0)	--MONEDA DE LA LINEA
,	LIMCRELIN	DECIMAL	(17,2)	--LIMITE DE LA LINEA
,	SALAUTLIN	DECIMAL	(17,2)	--SALDO AUTORIZADO DE LA LINEA
,	SALDISLIN	DECIMAL	(17,2)	--SALDO DISPUESTO DE LA LINEA
,	FILLER1	VARCHAR	(776)	--ESPACIO DISPONIBLE DEL REGISTRO
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_MI;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_MI  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMSECIMP	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO IMPAGADO
,	NUMMOVIMP	DECIMAL	(7,0)	--NUMERO DE MOVIMIENTO DEL RECIBO IMPAGADO
,	CLAMON	DECIMAL	(3,0)	--MONEDA
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	INDNORCOR	DECIMAL	(1,0)	--INDICADOR DE NORMAL O CORRECTORA
,	TIPOFAC	DECIMAL	(4,0)	--TIPO DE FACTURA
,	FECFAC	DATE		--FECHA DEL MOVIMIENTO
,	IMPORTE	DECIMAL	(17,2)	--IMPORTE DEL MOVIMIENTO
,	FECPROCES	DATE		--FECHA DE PROCESO DEL MOVIMIENTO
,	FECCONTA	DATE		--FECHA CONTABLE DEL MOVIMIENTO
,	ORIGENOPE	VARCHAR	(4)	--ORIGEN OPERACION
,	TIPDOCPAG	DECIMAL	(2,0)	--TIPO DE DOCUMENTO DE PAGO (SOLO PARA PAGOS)
,	REFDOCPAG	VARCHAR	(20)	--REFERENCIA DEL TIPO DE DOCUMENTO (SOLO PAGOS)
,	IMPAMORT	DECIMAL	(17,2)	--IMPORTE AMORTIZADO (SOLO PARA PAGOS)
,	TIPDEVOL	DECIMAL	(2,0)	--TIPOS DE IMPAGO
,	FEC2PRES	DATE		--FECHA VENCIMIENTO DE 2ª PRESENTACION
,	IMPIMPTO	DECIMAL	(17,2)	--IMPORTE DEL IMPUESTO
,	FILLER1	VARCHAR	(693)	--
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_MP;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_MP  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	NUMBENCTA	DECIMAL	(5,0)	--NUMERO DE BENEFICIARIO DENTRO DE LA CUENTA
,	CODMAR	DECIMAL	(2,0)	--CODIGO MARCA DE TARJETA
,	INDTIPT	DECIMAL	(2,0)	--INDICADOR DE TIPO DE TARJETA
,	PAN	VARCHAR	(22)	--PAN DE LA TARJETA
,	FECALTA	DATE		--FECHA DE ALTA DE LA TARJETA
,	FECULTUSO	DATE		--FECHA DE ULTIMO USO DE LA TARJETA
,	INDSITTAR	DECIMAL	(2,0)	--INDICADOR DE SITUACION 
,	CODBLQ	DECIMAL	(2,0)	--INDICADOR DE BLOQUEO 
,	FECCADTAR	DECIMAL	(6,0)	--FECHA DE CADUCIDAD DE LA TARJETA
,	MAXDIACAJ	DECIMAL	(6,0)	--MAXIMO DIARIO DE AJERO
,	NUMOPERCAJ	DECIMAL	(6,0)	--NUMERO DE OPERACIONES EN CAJERO
,	MAXOPER	DECIMAL	(6,0)	--MAXIMO NUMERO DE OPERACIONES POR PERIODO
,	NUMOPER	DECIMAL	(6,0)	--NUMERO DE OPERACIONES POR PERIODO
,	MAXODIA	DECIMAL	(6,0)	--MAXIMO NUMERO DE OPERACIONES POR DIA
,	NUMODIA	DECIMAL	(6,0)	--NUMERO DE OPERACIONES DIARIA
,	OFFSET1	DECIMAL	(4,0)	--OFFSET1
,	LIMDIACAJ	DECIMAL	(17,2)	--LIMITE DIARIO EN CAJERO
,	SALDIACAJ	DECIMAL	(17,2)	--SALDO DIARIO DE CAJERO
,	LIMCRETAR	DECIMAL	(17,2)	--LIMITE DE CREDITO DE TARJETA. LIMITE GLOBAL DE LA TARJETA
,	LIMCRETARTEM	DECIMAL	(17,2)	--LIMITE DE CREDITO TEMPORAL DE TARJETA. LIMITE GLOBAL TEMPORAL DE LA TARJETA
,	FECINICRETAR	DATE		--INICIO VIGENCIA LIMITE TEMPORAL. CREDITO DE LA TARJETA
,	FECFINCRETAR	DATE		--FIN VIGENCIA LIMITE TEMPORAL CREDITO DE LA TARJETA
,	LIMCREMES	DECIMAL	(17,2)	--LIMITE DE CREDITO MENSUAL. LIMITE MENSUAL CUANDO NO HAY RESTRICCION A NIVEL DE ACTIVIDAD O COMERCIO.
,	LIMCREMESTEM	DECIMAL	(17,2)	--LIMITE DE CREDITO TEMPORAL MENSUAL. LIMITE MENSUAL CUANDO NO HAY RESTRICCION A NIVEL DE ACTIVIDAD O COMERCIO.
,	FECINICREMES	DATE		--INICIO VIGENCIA LIMITE TEMPORAL CREDITO MENSUAL 
,	FECFINCREMES	DATE		--FIN VIGENCIA LIMITE TEMPORAL CREDITO MENSUAL
,	LIMDEBMES	DECIMAL	(17,2)	--LIMITE DE DEBITO MENSUAL.
,	LIMDEBMESTEM	DECIMAL	(17,2)	--LIMITE DE DEBITO TEMPORAL MENSUAL 
,	FECINIDEBMES	DATE		--INICIO VIGENCIA LIMITE TEMPORAL DEBITO MENSUAL
,	FECFINDEBMES	DATE		--FIN VIGENCIA LIMITE TEMPORAL DEBITO MENSUAL
,	FECAUTDIA	DATE		--FECHA DE AUTORIZACION DIARIA
,	LIMCREDIA	DECIMAL	(17,2)	--LIMITE DE CREDITO DIARIO
,	LIMCREDIATEM	DECIMAL	(17,2)	--LIMITE DE CREDITO TEMPORAL DIARIO 
,	FECINICREDIA	DATE		--INICIO VIGENCIA LIMITE TEMPORAL CREDITO DIARIO 
,	FECFINCREDIA	DATE		--FIN VIGENCIA LIMITE TEMPORAL CREDITO DIARIO
,	LIMDEBDIA	DECIMAL	(17,2)	--LIMITE DE DEBITO DIARIO.
,	LIMDEBDIATEM	DECIMAL	(17,2)	--LIMITE DE DEBITO TEMPORAL DIARIO 
,	FECINIDEBDIA	DATE		--INICIO VIGENCIA LIMITE TEMPORAL DEBITO MENSUAL 
,	FECFINDEBDIA	DATE		--FIN VIGENCIA LIMITE TEMPORAL DEBITO MENSUAL
,	SALAUTCREMES	DECIMAL	(17,2)	--SALDO AUTORIZADO A CREDITO MENSUAL
,	SALAUTDEBMES	DECIMAL	(17,2)	--SALDO AUTORIZADO A DEBITO MENSUAL
,	SALAUTCRED	DECIMAL	(17,2)	--SALDO AUTORIZADO A CREDITO DIARIO
,	SALAUTDEBD	DECIMAL	(17,2)	--SALDO AUTORIZADO A DEBITO DIARIO
,	FECACUSER	DATE		--FECHA ACUSE DE RECIBO
,	FECULTREN	DATE		--FECHA ULTIMO REENVIO
,	CODAGENTE	VARCHAR	(6)	--CODIGO DE AGENTE
,	FECCADTARANT	DECIMAL	(6,0)	--FECHA DE CADUCIDAD ANTERIOR DE LA TARJETA 
,	CALPART	VARCHAR	(2)	--CALIDAD DE PARTICIPACION
,	MOTBLQ	DECIMAL	(2,0)	--MOTIVO DE BLOQUEO
,	FILLER1	VARCHAR	(324)	--ESPACIO DISPONIBLE DEL REGISTRO
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_PU;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_PU  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	PAN	DECIMAL	(22,0)	--NUMERO DE TARJETA
,	PTOSGANAMESANT	DECIMAL	(8,0)	--PUNTOS GANADOS MES ANTERIOR
,	PTOSCANJMESANT	DECIMAL	(8,0)	--PUNTOS CANJEADOS MES ANTERIOR
,	PTOSVENCMES	DECIMAL	(8,0)	--PUNTOS VENCIDOS EN EL MES
,	PTOSPERDMES	DECIMAL	(8,0)	--PUNTOS PERDIDOS EN EL MES
,	PTOSCANJMES	DECIMAL	(8,0)	--PUNTOS CANJEADOS EN EL MES
,	PTOSGANAMES	DECIMAL	(8,0)	--PUNTOS GANADOS EN EL MES
,	PTOSDISP	DECIMAL	(8,0)	--PUNTOS DISPONIBLES
,	PTOSPROXCAD	DECIMAL	(8,0)	--PUNTOS PROXIMOS A CADUCAR
,	FILLER1	VARCHAR	(760)	--
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_RI;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_RI  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	CLAMON	DECIMAL	(3,0)	--MONEDA
,	NUMSECIMP	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO IMPAGADO
,	NUMSECREC	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO ORIGINAL
,	FECALTA	DATE		--FECHA DE ALTA DEL RECIBO IMPAGADO
,	FECEMIMOV	DATE		--FECHA EMISION DEL RECIBO 
,	FECVENMOV	DATE		--FECHA DE VENCIMIENTO DEL RECIBO
,	IMPREC	DECIMAL	(17,2)	--IMPORTE DEL RECIBO IMPAGADO
,	IMPAGO	DECIMAL	(17,2)	--IMPORTE TOTAL DEL IMPAGO. (INCLUYE INTERESES Y COMISIONES DE MORA)
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO
,	FECULTAPL	DATE		--FECHA DE ULTIMA APLICACION
,	FECENVCOB	DATE		--FECHA DE ENVIO A LA APLICACION DE COBRANZAS
,	FILLER1	VARCHAR	(712)	--
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCENVPO1_RL;  CREATE TABLE IF NOT EXISTS SAT.PCENVPO1_RL  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--‘CU’ – CUENTA DE MEDIOS DE PAGO 	 	 		
--‘LI’ – LINEAS ASOCIADAS A LA CUENTA	 	 		
--‘MP’ – MEDIO DE PAGO (TARJETA)	 	 		
--‘IC’ – CONTRATO IMPAGADO	 	 		
--‘IL’ – DESGLOSE CONTRATO IMPAGADO	 	 		
--‘RI’ – RECIBO IMPAGADO	 	 		
--‘RL’ – DESGLOSE RECIBO IMPAGADO	 	 		
--‘MI’ – MOVIMIENTO RECIBO IMPAGADO	 	 		
--‘CI’ – CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMSECIMP	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO IMPAGADO
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE
---        01 – CAPITAL	 	 		
---        02 – COMISIONES	 	 		
---        03 – INTERESES	 	 		
---        04 - IMPUESTOS	 	 		
---        05 – COMISIONES MOROSIDAD	 	 		
---        06 – INTERESES MOROSIDAD	 	 		
---        07 – IMPUESTOS MOROSIDAD	 	 		
---        08- SEGURIDAD	 	 		
,	IMPORTE	DECIMAL	(17,2)	--IMPORTE CORRESPONDIENTE AL TIPO DE IMPORTE
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO AL TIPO DE IMPORTE
,	FILLER1	VARCHAR	(791)	--
); COMMIT;	 	 		

-- CREACION DE TABLAS STAGE.----
DROP TABLE IF EXISTS "STG"."PCENVPO1_CI";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_CI";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_CI";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_CI" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMSECIMP" DECIMAL(15,0) NULL ,
	"NUMMOVIMP" DECIMAL(7,0) NULL ,
	"CODCONECO" DECIMAL(4,0) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"IMPAPLECO" DECIMAL(17,2) NULL ,
	"IMPBRUECO" DECIMAL(17,2) NULL ,
	"IMPBONECO" DECIMAL(17,2) NULL ,
	"IMPIMPTO" DECIMAL(17,2) NULL ,
	"IMPCONSOL" DECIMAL(17,2) NULL ,
	"PORINT" DECIMAL(7,4) NULL ,
	"INDPERCON" VARCHAR(1) NULL ,
	"FILLER1" VARCHAR(725) NULL 
) COMMIT;

DROP TABLE IF EXISTS "STG"."PCENVPO1_CU";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_CU";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_CU";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_CU" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"FECULTCAR" VARCHAR(10) NULL ,
	"PRODUCTO" VARCHAR(2) NULL ,
	"SUBPRODU" VARCHAR(4) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"LIMCRECTA" DECIMAL(17,2) NULL ,
	"LIMCRECTATEM" DECIMAL(17,2) NULL ,
	"FECINITEM" VARCHAR(10) NULL ,
	"FECFINTEM" VARCHAR(10) NULL ,
	"SALAUTCRE" DECIMAL(17,2) NULL ,
	"SALDISCRE" DECIMAL(17,2) NULL ,
	"LIMCRECTAC" DECIMAL(17,2) NULL ,
	"SALAUTCREC" DECIMAL(17,2) NULL ,
	"SALDISCREC" DECIMAL(17,2) NULL ,
	"FECPROVEN" VARCHAR(10) NULL ,
	"FECULTVEN" VARCHAR(10) NULL ,
	"FECRESOL" VARCHAR(10) NULL ,
	"IDENTCLI" VARCHAR(8) NULL ,
	"CODESTCTA" DECIMAL(2,0) NULL ,
	"FECULTESTCTA" VARCHAR(10) NULL ,
	"CODCONVEN" VARCHAR(4) NULL ,
	"INDCTAEMP" DECIMAL(1,0) NULL ,
	"INDDOMCARCRE" VARCHAR(1) NULL ,
	"IBAN" VARCHAR(4) NULL ,
	"CTACARGO" VARCHAR(30) NULL ,
	"FORPAGO" DECIMAL(2,0) NULL ,
	"INDSITCTA" DECIMAL(1,0) NULL ,
	"COMISIONES" DECIMAL(17,2) NULL ,
	"INTERESES" DECIMAL(17,2) NULL ,
	"CAPITAL" DECIMAL(17,2) NULL ,
	"GRUPOLIQ" DECIMAL(2,0) NULL ,
	"CODBLQULT" DECIMAL(2,0) NULL ,
	"IMPMINORIGINAL" DECIMAL(17,2) NULL ,
	"IMPMINPENDIENTE" DECIMAL(17,2) NULL ,
	"MOTBLQ" DECIMAL(2,0) NULL ,
	"FILLER1" VARCHAR(142) NULL ,
	"CODVIAJFRE" VARCHAR(25) NULL ,
	"FECALTAVIAJ" VARCHAR(10) NULL ,
	"INDCLICUMM" VARCHAR(1) NULL ,
	"INDCLICUMC" VARCHAR(1) NULL ,
	"FECCLICUM" VARCHAR(10) NULL ,
	"CLASIFRISAT" VARCHAR(2) NULL ,
	"CLASIFRIREG" VARCHAR(2) NULL ,
	"CLASIFRIMDE" VARCHAR(5) NULL ,
	"TASAEFECMAX" DECIMAL(7,4) NULL ,
	"FILLER2" VARCHAR(299) NULL 
) COMMIT;


DROP TABLE IF EXISTS "STG"."PCENVPO1_IC";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_IC";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_IC";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_IC" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"SITUACION" DECIMAL(2,0) NULL ,
	"IMPCONT" DECIMAL(17,2) NULL ,
	"IMPAGO" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"FECULTAPL" VARCHAR(10) NULL ,
	"FECENVCOB" VARCHAR(10) NULL ,
	"FILLER1" VARCHAR(770) NULL 
) COMMIT;


DROP TABLE IF EXISTS "STG"."PCENVPO1_IL";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_IL";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_IL";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_IL" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"IMPORTE" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(803) NULL 
) COMMIT;


DROP TABLE IF EXISTS "STG"."PCENVPO1_LI";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_LI";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_LI";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_LI" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"LINREF" DECIMAL(8,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"CODCAMCOM" VARCHAR(4) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"LIMCRELIN" DECIMAL(17,2) NULL ,
	"SALAUTLIN" DECIMAL(17,2) NULL ,
	"SALDISLIN" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(776) NULL 
) COMMIT;


DROP TABLE IF EXISTS "STG"."PCENVPO1_MI";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_MI";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_MI";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_MI" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMSECIMP" DECIMAL(15,0) NULL ,
	"NUMMOVIMP" DECIMAL(7,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"INDNORCOR" DECIMAL(1,0) NULL ,
	"TIPOFAC" DECIMAL(4,0) NULL ,
	"FECFAC" VARCHAR(10) NULL ,
	"IMPORTE" DECIMAL(17,2) NULL ,
	"FECPROCES" VARCHAR(10) NULL ,
	"FECCONTA" VARCHAR(10) NULL ,
	"ORIGENOPE" VARCHAR(4) NULL ,
	"TIPDOCPAG" DECIMAL(2,0) NULL ,
	"REFDOCPAG" VARCHAR(20) NULL ,
	"IMPAMORT" DECIMAL(17,2) NULL ,
	"TIPDEVOL" DECIMAL(2,0) NULL ,
	"FEC2PRES" VARCHAR(10) NULL ,
	"IMPIMPTO" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(693) NULL 
) COMMIT;


DROP TABLE IF EXISTS "STG"."PCENVPO1_MP";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_MP";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_MP";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_MP" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"NUMBENCTA" DECIMAL(5,0) NULL ,
	"CODMAR" DECIMAL(2,0) NULL ,
	"INDTIPT" DECIMAL(2,0) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"FECALTA" VARCHAR(10) NULL ,
	"FECULTUSO" VARCHAR(10) NULL ,
	"INDSITTAR" DECIMAL(2,0) NULL ,
	"CODBLQ" DECIMAL(2,0) NULL ,
	"FECCADTAR" DECIMAL(6,0) NULL ,
	"MAXDIACAJ" DECIMAL(6,0) NULL ,
	"NUMOPERCAJ" DECIMAL(6,0) NULL ,
	"MAXOPER" DECIMAL(6,0) NULL ,
	"NUMOPER" DECIMAL(6,0) NULL ,
	"MAXODIA" DECIMAL(6,0) NULL ,
	"NUMODIA" DECIMAL(6,0) NULL ,
	"OFFSET1" DECIMAL(4,0) NULL ,
	"LIMDIACAJ" DECIMAL(17,2) NULL ,
	"SALDIACAJ" DECIMAL(17,2) NULL ,
	"LIMCRETAR" DECIMAL(17,2) NULL ,
	"LIMCRETARTEM" DECIMAL(17,2) NULL ,
	"FECINICRETAR" VARCHAR(10) NULL ,
	"FECFINCRETAR" VARCHAR(10) NULL ,
	"LIMCREMES" DECIMAL(17,2) NULL ,
	"LIMCREMESTEM" DECIMAL(17,2) NULL ,
	"FECINICREMES" VARCHAR(10) NULL ,
	"FECFINCREMES" VARCHAR(10) NULL ,
	"LIMDEBMES" DECIMAL(17,2) NULL ,
	"LIMDEBMESTEM" DECIMAL(17,2) NULL ,
	"FECINIDEBMES" VARCHAR(10) NULL ,
	"FECFINDEBMES" VARCHAR(10) NULL ,
	"FECAUTDIA" VARCHAR(10) NULL ,
	"LIMCREDIA" DECIMAL(17,2) NULL ,
	"LIMCREDIATEM" DECIMAL(17,2) NULL ,
	"FECINICREDIA" VARCHAR(10) NULL ,
	"FECFINCREDIA" VARCHAR(10) NULL ,
	"LIMDEBDIA" DECIMAL(17,2) NULL ,
	"LIMDEBDIATEM" DECIMAL(17,2) NULL ,
	"FECINIDEBDIA" VARCHAR(10) NULL ,
	"FECFINDEBDIA" VARCHAR(10) NULL ,
	"SALAUTCREMES" DECIMAL(17,2) NULL ,
	"SALAUTDEBMES" DECIMAL(17,2) NULL ,
	"SALAUTCRED" DECIMAL(17,2) NULL ,
	"SALAUTDEBD" DECIMAL(17,2) NULL ,
	"FECACUSER" VARCHAR(10) NULL ,
	"FECULTREN" VARCHAR(10) NULL ,
	"CODAGENTE" VARCHAR(6) NULL ,
	"FECCADTARANT" DECIMAL(6,0) NULL ,
	"CALPART" VARCHAR(2) NULL ,
	"MOTBLQ" DECIMAL(2,0) NULL ,
	"FILLER1" VARCHAR(324) NULL 
) COMMIT;


DROP TABLE IF EXISTS "STG"."PCENVPO1_PU";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_PU";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_PU";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_PU" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"PAN" DECIMAL(22,0) NULL ,
	"PTOSGANAMESANT" DECIMAL(8,0) NULL ,
	"PTOSCANJMESANT" DECIMAL(8,0) NULL ,
	"PTOSVENCMES" DECIMAL(8,0) NULL ,
	"PTOSPERDMES" DECIMAL(8,0) NULL ,
	"PTOSCANJMES" DECIMAL(8,0) NULL ,
	"PTOSGANAMES" DECIMAL(8,0) NULL ,
	"PTOSDISP" DECIMAL(8,0) NULL ,
	"PTOSPROXCAD" DECIMAL(8,0) NULL ,
	"FILLER1" VARCHAR(760) NULL 
) COMMIT;


DROP TABLE IF EXISTS "STG"."PCENVPO1_RI";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_RI";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_RI";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_RI" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"NUMSECIMP" DECIMAL(15,0) NULL ,
	"NUMSECREC" DECIMAL(15,0) NULL ,
	"FECALTA" VARCHAR(10) NULL ,
	"FECEMIMOV" VARCHAR(10) NULL ,
	"FECVENMOV" VARCHAR(10) NULL ,
	"IMPREC" DECIMAL(17,2) NULL ,
	"IMPAGO" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"FECULTAPL" VARCHAR(10) NULL ,
	"FECENVCOB" VARCHAR(10) NULL ,
	"FILLER1" VARCHAR(712) NULL 
) COMMIT;


DROP TABLE IF EXISTS "STG"."PCENVPO1_RL";
DROP TABLE IF EXISTS "STG_SAT"."PCENVPO1_RL";
DROP TABLE IF EXISTS "DWH_ETLS"."PCENVPO1_RL";
COMMIT;

CREATE TABLE IF NOT EXISTS "STG_SAT"."PCENVPO1_RL" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMSECIMP" DECIMAL(15,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"IMPORTE" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(791) NULL 
) COMMIT;

