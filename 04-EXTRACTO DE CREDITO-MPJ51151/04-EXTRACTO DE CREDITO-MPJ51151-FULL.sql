--- creacion de grupo de usuarios SAT---
IF NOT EXISTS (SELECT 1 FROM DBO.SYSUSERS WHERE name = 'SAT')
BEGIN
CREATE USER SAT 
FORCE PASSWORD CHANGE OFF;
END;
COMMIT;

--- creacion de grupo de usuarios STG_SAT
IF NOT EXISTS (SELECT 1 FROM DBO.SYSUSERS WHERE name = 'STG_SAT')
BEGIN
CREATE USER STG_SAT 
FORCE PASSWORD CHANGE OFF;
END;
COMMIT;

------------------------------
-- INTERFAZ IMPRESION EXTRACTO DE CREDITO
--------------------------------
--- creacion de grupo de usuarios SAT
IF NOT EXISTS (SELECT 1 FROM DBO.SYSUSERS WHERE name = 'SAT')
BEGIN
CREATE USER SAT 
FORCE PASSWORD CHANGE OFF;
END;
COMMIT;

--- creacion de grupo de usuarios STG
IF NOT EXISTS (SELECT 1 FROM DBO.SYSUSERS WHERE name = 'STG_SAT')
BEGIN
CREATE USER STG_SAT
FORCE PASSWORD CHANGE OFF;
END;
COMMIT;
------------------------------
-- INTERFAZ  EXTRACTO DE CREDITO
--------------------------------
---TIPO DE REGISTRO                                         
---CL DATOS DE CLIENTE                                -TABLA PCIMPEXT_CL
---CU  CUENTA O CONTRATO DE TARJETA                    -TABLA PCIMPEXT_CU
---LI  LÍNEAS DE CRÉDITO PARALELAS                     -TABLA PCIMPEXT_LI
---EX  EXTRACTO                                        -TABLA PCIMPEXT_EX
---TX  EXTRACTO  TIPO DE LÍNEA  TIPO IMPORTE         -TABLA PCIMPEXT_TX
---MX  MOVIMIENTO EXTRACTO                             -TABLA PCIMPEXT_MX
---MC  MOVIMIENTO CONCEPTO ECONÓMICO                   -TABLA PCIMPEXT_MC
---IC  CONTRATO IMPAGADO                               -TABLA PCIMPEXT_IC
---IL  DESGLOSE CONTRATO IMPAGADO                      -TABLA PCIMPEXT_IL
---RI  RECIBO IMPAGADO                                 -TABLA PCIMPEXT_RI
---RL  DESGLOSE RECIBO IMPAGADO                        -TABLA PCIMPEXT_RL
---MI  MOVIMIENTO RECIBO IMPAGADO                      -TABLA PCIMPEXT_MI
---CI  CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO IMPAGADO-TABLA PCIMPEXT_CI
---ME -													-TABLA PCIMPEXT_ME
---PU   PUNTOS DE FIDELIZACION SFC O B.LEON           -TABLA PCIMPEXT_PU
---ML   LÍNEAS DE MENSAJERIA PARA EXTRACTOS            -TABLA PCIMPEXT_ML
---MS   MANEJO DE MENSAJES PROMOCIONALES               -TABLA PCIMPEXT_MS
---MZ   BONIFICACION ONLINE DE CAMPAÑAS                -TABLA PCIMPEXT_MZ
---PZ   PAGOS APLICADOS CUSCATLAN                      -TABLA PCIMPEXT_PZ
---RZ   PAGO MINIMO CUSCATLAN                          -TABLA PCIMPEXT_RZ
---SZ   SALDO ACTUAL CUSCATLAN                         -TABLA PCIMPEXT_SZ

drop table IF EXISTS SAT.PCIMPEXT_CI;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_CI  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMSECIMP	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO IMPAGADO
,	NUMMOVIMP	DECIMAL	(7,0)	--NUMERO DE MOVIMIENTO DEL RECIBO IMPAGADO
,	CODCONECO	DECIMAL	(4,0)	--CODIGO DE CONCEPTO ECONOMICO
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE
---        02 - COMISIONES	 	 		
---        03 - INTERESES	 	 		
---        04 - IMPUESTOS	 	 		
---        05 - COMISIONES MOROSIDAD	 	 		
---        06 - INTERESES MOROSIDAD	 	 		
---        07 - IMPUESTOS MOROSIDAD	 	 		
---        08 - SEGURO	 	 		
,	IMPAPLECO	DECIMAL	(17,2)	--IMPORTE SOBRE EL QUE SE APLICA EL CONCEPTO ECONOMICO
,	IMPBRUECO	DECIMAL	(17,2)	--IMPORTE BRUTO CALCULADO POR EL CONCEPTO ECONOMICO
,	IMPBONECO	DECIMAL	(17,2)	--IMPORTE DE BONIFICACION CALCULADO POR EL CONCEPTO ECONOMICO
,	IMPIMPTO	DECIMAL	(17,2)	--IMPORTE DEL IMPUESTO
,	IMPCONSOL	DECIMAL	(17,2)	--IMPORTE CONSOLIDADO
,	PORINT	DECIMAL	(7,4)	--PORCENTAJE DE INTERES APLICADO
,	INDPERCON	VARCHAR	(1)	--INDICADOR DE CONCEPTO PERDONADO
,	FILLER1	VARCHAR	(823)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_CU;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_CU  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	PRODUCTO	VARCHAR	(2)	--CODIGO DE PRODUCTO
,	SUBPRODU	VARCHAR	(4)	--CODIGO DE SUBPRODUCTO
,	CONPROD	VARCHAR	(3)	--CODIGO DE CONDICION ECONOMICA
,	CALPART	VARCHAR	(2)	--CALIDAD DE PARTICIPACION, IDENTIFICADOR DE CLIENTE
,	NUMBEN	DECIMAL	(5,0)	--NUMERO DE BENEFICIARIOS DE LA CUENTA
,	CODREGIMEN	DECIMAL	(4,0)	--CODIGO DE REGIMEN FISCAL
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA 
,	LIMCRECTA	DECIMAL	(17,2)	--LIMITE DE CREDITO DE LA CUENTA O CONTRATO DE TARJETA
,	SALDISCRE	DECIMAL	(17,2)	--SALDO DISPUESTO A CREDITO
,	LIMCRECTAC	DECIMAL	(17,2)	--LIMITE DE CREDITO DE LA CUENTA O CONTRATO DE TARJETA DE CUOTAS
,	SALDISCREC	DECIMAL	(17,2)	--SALDO DISPUESTO A CREDITO DE CUOTAS
,	INDMONPRIN	VARCHAR	(1)	--INDICADOR DE MONEDA PRINCIPAL (S/N)
,	CODFORMATO	VARCHAR	(10)	--CODIGO DE FORMATO
,	IDENTCLI	VARCHAR	(8)	--IDENTIFICADOR DE CLIENTE
,	INDDOMCARCRE	VARCHAR	(1)	--INDICADOR DOMICILIACION
,	INDCTAEMP	DECIMAL	(1,0)	--INDICADOR CUENTA EMPRESA
,	CLASEG	VARCHAR	(3)	--CLASE DE SEGMENTO DEL CLIENTE(TIPO DE CLIENTE)
--01 - CLIENTE	 	 		
--02 - EMPLEADO	 	 		
,	IBAN	VARCHAR	(4)	--IBAN DE LA CUENTA DE CARGO
,	CTACARGO	VARCHAR	(30)	--CUENTA DE CARGO O DOMICILIACION
,	CODIDIOMA 	VARCHAR	(2)	--CODIGO DE IDIOMA
,	CODBLQ	DECIMAL	(2,0)	--CODIGO DE BLOQUEO
,	DISBLECRECTA	DECIMAL	(17,2)	--DISPONIBLE CREDITO CUENTA
,	DISBLECRECTAC	DECIMAL	(17,2)	--DISPONIBLE CREDITO CUENTA
,	GRUPOLIQ	DECIMAL	(2,0)	--GRUPO DE LIQUIDACION
,	DESPROD	VARCHAR	(30)	--DESCRIPCION DEL PRODUCTO
,	INTERESANUAL1	DECIMAL	(9,4)	--INTERES ANUAL MONEDA 1
,	INTERESANUAL2	DECIMAL	(9,4)	--INTERES ANUAL MONEDA 2
,	BALANPAGO	DECIMAL	(19,2)	--BALANCE DE PAGO (FACTURA INFORMATIVA INTERES BONIFICABLE 9205)
,	NOMBREMP	VARCHAR	(30)	--NOMBRE DE EMPRESA
,	GRUPOEMP	DECIMAL	(4,0)	--GRUPO EMPRESA
,	PORMOPPAL	DECIMAL	(9,4)	--PORCENTAJE MORA MONEDA PRINCIPAL
,	TRAMOPPAL	DECIMAL	(17,2)	--IMPORTE FIJO MORA MONEDA PRINCIPAL
,	PORMOSEC	DECIMAL	(9,4)	--PORCENTAJE MORA MONEDA SECUNDARIA
,	TRAMOSEC	DECIMAL	(17,2)	--IMPORTE FIJO MORA MONEDA SECUNDARIA
,	INTANUALPPAL	DECIMAL	(9,4)	--INTERES ANUAL MONEDA PRINCIPAL
,	INTANUALSEC	DECIMAL	(9,4)	--INTERES ANUAL MONEDA SECUNDARIA
,	LIMCRECTAPPAL	DECIMAL	(17,2)	--LIMITE DE CREDITO MONEDA PRINCIPAL
,	LIMCRECTASEC	DECIMAL	(17,2)	--LIMITE DE CREDITO MONEDA SECUNDARIA
,	MOTBLQ	DECIMAL	(2,0)	--MOTIVO DE BLOQUEO
,	FILLER1	VARCHAR	(539)	--FILLER
,	FILLER2	VARCHAR	(9)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_EX;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_EX  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA 
,	INDREP	DECIMAL	(1,0)	--INDICADOR DE RELIQUIDACION DE EXTRACTO
---         0 - NORMAL	 	 		
---         2 - RELIQUIDADO	 	 		
,	FORPAGO	DECIMAL	(2,0)	--FORMA DE PAGO 
,	IMPTOTPAG	DECIMAL	(17,2)	--IMPORTE TOTAL A PAGAR
,	IMPMIN	DECIMAL	(17,2)	--IMPORTE MINIMO DE PAGO
,	IMPCARGO	DECIMAL	(17,2)	--IMPORTE DE CARGO MENSUAL CALCULADO SEGUN FORMA DE PAGO
,	FECEXT	DATE		--FECHA DE EXTRACTO
,	FECLIQ	DATE		--FECHA DE LIQUIDACION
,	FECLIQANT	DATE		--FECHA DE LIQUIDACION ANTERIOR
,	FECCAR	DATE		--FECHA DE CARGO EXTRACTO
,	FECVALCAR	DATE		--FECHA VALOR DEL CARGO EXTRACTO
,	PORINT	DECIMAL	(7,4)	--PORCENTAJE DE INTERES
,	PORPAGOA 	DECIMAL	(7,4)	--PORCENTAJE PAGO APLAZADO
,	IMPEXCLIM	DECIMAL	(17,2)	--IMPORTE EXCESO DEL LIMITE DE CREDITO
,	IMSALAPLPRX	DECIMAL	(17,2)	--IMPORTE APLAZADO
,	IMPCARGOANT	DECIMAL	(17,2)	--IMPORTE DEL CARGO MENSUAL CALCULADO SEGUN FORMA DE PAGO
,	NUMSECREC	DECIMAL	(15,0)	--NUMERO SECUENCIAL DEL RECIBO
,	IMPDISBLEEXC	DECIMAL	(17,2)	--IMPORTE DE EXCESO DE LIMITE - IMPORTE SALDO APLAZADO
,	FECVENMOV	VARCHAR	(10)	--FECHA DE VENCIMIENTO DE MOVIMIENTO
,	MX_POS	DECIMAL	(17,2)	--TOTAL PAGOS CREDITO POSITIVOS
,	MX_NEG	DECIMAL	(17,2)	--TOTAL PAGOS CREDITO NEGATIVOS
,	MC_POS	DECIMAL	(17,2)	--TOTAL PAGOS CUOTAS POSITIVOS
,	MC_NEG	DECIMAL	(17,2)	--TOTAL PAGOS CUOTAS NEGATIVOS
,	BALMESANT	DECIMAL	(17,2)	--BALANCE MES ANTERIOR (IMPORTE FINAL EXTRACTO)
,	BALMESACT	DECIMAL	(17,2)	--BALANCE MES ACTUAL (IMPORTE INICIAL EXTRACTO)
,	INTBONIF	DECIMAL	(17,2)	--INTERES BONIFICABLE (FACTURA INFORMATIVA 9205)
,	BALMESACTBON	DECIMAL	(17,2)	--BALANCE MES ACTUAL + INTERES BONIFICABLE
,	CUOTAMIN	DECIMAL	(17,2)	--PAGO MENSUAL (APLICANDO PAGO MINIMO) DE LA FINANCIACION DE LA DEUDA
,	PLAZOMIN	DECIMAL	(3,0)	--NUMERO DE MESES (APLICANDO PAGO MINIMO) DE LA FINANCIACION DE LA DEUDA
,	IMPTOTMIN	DECIMAL	(17,2)	--IMPORTE TOTAL DE LA FINANCIACION DE LA DEUDA (APLICANDO PAGO MINIMO) 
,	CUOTA12	DECIMAL	(17,2)	--PAGO MENSUAL (APLICANDO FINANCIACION ANUAL 12 MESES) DE LA FINANCIACION DE LA DEUDA
,	PLAZO12	DECIMAL	(3,0)	--NUMERO DE MESES (ANUAL = 12) DE LA FINANCIACION DE LA DEUDA
,	IMPTOTAL12	DECIMAL	(17,2)	--IMPORTE TOTAL DE LA FINANCIACION DE LA DEUDA (APLICANDO FIANCIACION ANUAL 12 MESES)
,	TOT_POS	DECIMAL	(17,2)	--TOTAL DEBITOS (CONSUMOS + COMISIONES + INTERESES)
,	TOT_NEG	DECIMAL	(17,2)	--TOTAL CREDITOS (ABONOS + COMISIONES + INTERESES)
,	BALPROVANT	DECIMAL	(17,2)	--BALANCE PROMEDIO OPERACIONES VIVAS EXTRACTO ANTERIOR (FACTURA 200 DEL EXTRACTO ANTERIOR)
,	BALPROVACT	DECIMAL	(17,2)	--BALANCE PROMEDIO OPERACIONES VIVAS EXTRACTO ACTUAL (FACTURA 200 DEL EXTRACTO ACTUAL)
,	IMPMINREV	DECIMAL	(17,2)	--IMPORTE MINIMO DE REVOLVING
,	IMPMINCC	DECIMAL	(17,2)	--IMPORTE MINIMO DE COMPRAS EN CUOTAS
,	IMPRECREV	DECIMAL	(17,2)	--IMPORTE RECIBO DE REVOLVING
,	IMPRECCC	DECIMAL	(17,2)	--IMPORTE RECIBO DE COMPRAS EN CUOTAS
,	IMPFINREV	DECIMAL	(17,2)	--IMPORTE FINAL DE REVOLVING
,	IMPFINCC	DECIMAL	(17,2)	--IMPORTE FINAL DE COMPRAS EN CUOTAS
,	IMPUESTO	DECIMAL	(17,2)	--TOTAL DE IMPUESTO SOBRE COMISIONES
,	TASAEFEXT	DECIMAL	(7,4)	--TASA EFECTIVA MAXIMA DE INTERES DEL EXTRACTO
,	BONCAMPAN	DECIMAL	(17,2)	--BONIFICACIONES ONLINE DE CAMPANAS
,	BALMESTOTANT	DECIMAL	(17,2)	--BALANCE ANTERIOR TOTAL (INCLUYE DIFERIDO)
,	BALMESTOTAC	DECIMAL	(17,2)	--BALANCE ACTUAL TOTAL (INCLUYE DIFERIDO)
,	BALMESANTREV	DECIMAL	(14,2)	--BALANCE MES ANTERIOR LINEAS REVOLVENTES
,	BALMESACTREV	DECIMAL	(14,2)	--BALANCE MES ACTUAL LINEAS REVOLVENTES
,	BALMESANTDIF	DECIMAL	(14,2)	--BALANCE MES ANTERIOR LINEAS DIFERIDAS
,	BALMESACTDIF	DECIMAL	(14,2)	--BALANCE MES ACTUAL LINEAS DIFERIDAS
,	MX_POS_REV	DECIMAL	(14,2)	--CONSUMOS DEL REVOLVENTES
,	MX_NEG_REV	DECIMAL	(14,2)	--CREDITOS Y PAGOS DEL REVOLVENTE
,	MX_POS_DIF	DECIMAL	(14,2)	--CONSUMOS DEL DIFERIDO
,	MX_NEG_DIF	DECIMAL	(14,2)	--CREDITOS Y PAGOS DEL DIFERIDO
,	MC_POS_REV	DECIMAL	(14,2)	--CONCEPTOS ECONOMICOS DEBITO DEL REVOLVENTE
,	MC_NEG_REV	DECIMAL	(14,2)	--CONCEPTOS ECONOMICOS CREDITO DEL REVOLVENTE
,	MC_POS_DIF	DECIMAL	(14,2)	--CONCEPTOS ECONOMICOS DEBITO DEL DIFERIDO
,	MC_NEG_DIF	DECIMAL	(14,2)	--CONCEPTOS ECONOMICOS CREDITO DEL DIFERIDO
,	TOT_POS_REV	DECIMAL	(14,2)	--TOTAL CONSUMOS DEL REVOLVENTE
,	TOT_NEG_REV	DECIMAL	(14,2)	--TOTAL CREDITOS Y PAGOS DEL REVOLVENTE
,	TOT_POS_DIF	DECIMAL	(14,2)	--TOTAL CONSUMOS DEL DIFERIDO
,	TOT_NEG_DIF	DECIMAL	(14,2)	--TOTAL CREDITOS Y PAGOS DEL DIFERIDO
,	IMP_COM	DECIMAL	(14,2)	--TOTAL DE COMISIONES SIN GRAVAMEN
,	FILLER1	VARCHAR	(34)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_IC;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_IC  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	CLAMON	DECIMAL	(3,0)	--MONEDA
,	SITUACION	DECIMAL	(2,0)	--SITUACION DEL CONTRATO IMPAGADO
,	IMPCONT	DECIMAL	(17,2)	--IMPORTE TOTAL DE IMPAGO DEL CONTRATO
,	IMPAGO	DECIMAL	(17,2)	--IMPORTE TOTAL EN IMPAGO, INCLUYE INTERESES Y COMISIONES DE MORA
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO (COBRADO)
,	FECULTAPL	DATE		--FECHA DE ULTIMA APLICACION
,	FECENVCOB	DATE		--FECHA DE ENVIO A LA APLICACION DE COBRANZAS
,	NUMRECIMP	DECIMAL	(2,0)	--NUMERO DE RECIBOS IMPAGADOS
,	FILLER1	VARCHAR	(866)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_IL;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_IL  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	CLAMON	DECIMAL	(3,0)	--MONEDA
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE
---         01 - CAPITAL	 	 		
---         02 - COMISIONES	 	 		
---         03 - INTERESES	 	 		
---         04 - IMPUESTOS	 	 		
---         05 - COMISIONES MOROSIDAD	 	 		
---         06 - INTERESES MOROSIDAD	 	 		
---         07 - IMPUESTOS MOROSIDAD	 	 		
---         08 - SEGURIDAD	 	 		
,	IMPORTE	DECIMAL	(17,2)	--IMPORTE CORRESPONDIENTE AL TIPO DE IMPORTE
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO AL TIPO DE IMPORTE
,	FILLER1	VARCHAR	(901)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_LI;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_LI  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	LINREF	DECIMAL	(8,0)	--REFERENCIA DE LINEA ASOCIADA A LA CUENTA
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA 
,	CODCAMCOM	VARCHAR	(4)	--CODIGO DE CAMPANA A LA CUAL ESTA ASOCIADA LA LINEA
,	CLAMON	DECIMAL	(3,0)	--MONEDA DE LA LINEA
,	LIMCRELIN	DECIMAL	(17,2)	--LIMITE DE LA LINEA
,	SALAUTLIN	DECIMAL	(17,2)	--SALDO AUTORIZADO DE LA LINEA
,	SALDISLIN	DECIMAL	(17,2)	--SALDO DISPUESTO DE LA LINEA
,	DISBLECRELIN	DECIMAL	(17,2)	--DISPONIBLE DE LA LINEA
,	FILLER1	VARCHAR	(857)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_MC;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_MC  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	NUMMOVEXT	DECIMAL	(7,0)	--NUMERO DE MOVIMIENTO EN EL EXTRACTO
,	CODCONECO	DECIMAL	(4,0)	--CODIGO DE CONCEPTO ECONOMICO 
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE:
---         02 - COMISIONES	 	 		
---         03 - INTERESES	 	 		
---         04 - IMPUESTOS	 	 		
---         05 - COMISIONES MOROSIDAD	 	 		
---         06 - INTERESES MOROSIDAD	 	 		
---         07 - IMPUESTOS MOROSIDAD	 	 		
---         08- SEGURO	 	 		
,	DESCONECO	VARCHAR	(30)	--DESCRIPCION DE CONCEPTO ECONOMICO
,	IMPAPLECO	DECIMAL	(17,2)	--IMPORTE SOBRE EL QUE SE APLICA EL CONCEPTO ECONOMICO
,	IMPBRUECO	DECIMAL	(17,2)	--IMPORTE BRUTO CALCULADO POR EL CONCEPTO ECONOMICO
,	IMPBONECO	DECIMAL	(17,2)	--IMPORTE DE BONIFICACION CALCULADO POR EL CONCEPTO ECONOMICO
,	IMPIMPTO	DECIMAL	(17,2)	--IMPORTE DEL IMPUESTO
,	SIGNO	VARCHAR	(1)	--SIGNO DEL CONCEPTO
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	FILLER1	VARCHAR	(822)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_MI;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_MI  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMSECIMP	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO IMPAGADO
,	NUMMOVIMP	DECIMAL	(7,0)	--NUMERO DE MOVIMIENTO DEL RECIBO IMPAGADO
,	CLAMON	DECIMAL	(3,0)	--MONEDA
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	INDNORCOR	DECIMAL	(1,0)	--INDICADOR DE NORMAL O CORRECTORA
,	TIPOFAC	DECIMAL	(4,0)	--TIPO DE FACTURA
,	FECFAC	DATE		--FECHA DEL MOVIMIENTO
,	IMPORTE	DECIMAL	(17,2)	--IMPORTE DEL MOVIMIENTO
,	FECPROCES	DATE		--FECHA DE PROCESO DEL MOVIMIENTO
,	FECCONTA	DATE		--FECHA CONTABLE DEL MOVIMIENTO
,	ORIGENOPE	VARCHAR	(4)	--ORIGEN OPERACION
,	TIPDOCPAG	DECIMAL	(2,0)	--TIPO DE DOCUMENTO DE PAGO (SOLO PARA PAGOS)
,	REFDOCPAG	VARCHAR	(20)	--REFERENCIA DEL TIPO DE DOCUMENTO (SOLO PAGOS)
,	IMPAMORT	DECIMAL	(17,2)	--IMPORTE AMORTIZADO (SOLO PARA PAGOS)
,	TIPDEVOL	DECIMAL	(2,0)	--TIPOS DE IMPAGO
,	FEC2PRES	DATE		--FECHA VENCIMIENTO DE 2a PRESENTACION
,	IMPIMPTO	DECIMAL	(17,2)	--IMPORTE DEL IMPUESTO
,	FILLER1	VARCHAR	(791)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_ML;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_ML  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	LINEA1	VARCHAR	(50)	--MENSAJE DE LINEA 1
,	FILLER1	VARCHAR	(894)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_MS;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_MS  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	TIPCASILLA	VARCHAR	(1)	--Tipo de casilla:
--1 - Casilla 1	 	 		
--2 - Casilla 2	 	 		
--3 - Casilla 3	 	 		
,	TIPOMSG	VARCHAR	(1)	--Tipo de mensaje: 
--·        G -  Generico	 	 		
--·        M - Por altura de mora	 	 		
--·        N - Para clientes nuevos	 	 		
,	MENSAJE	VARCHAR	(500)	--Mensaje asociado a la cuenta
,	FILLER1	VARCHAR	(442)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_MX;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_MX  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	NUMMOVEXT	DECIMAL	(7,0)	--NUMERO DE MOVIMIENTO EN EL EXTRACTO
,	INDNORCOR	DECIMAL	(1,0)	--INDICADOR DE TI PO DE FACTURA NORMAL O CORRECTORA
---         0 - NORMAL	 	 		
---         1 - CORRECTORA	 	 		
,	TIPOFAC	DECIMAL	(4,0)	--TIPO DE FACTURA
,	SIGNO	VARCHAR	(1)	--SIGNO DEL IMPORTE
,	DESTIPFAC	VARCHAR	(30)	--DESCRIPCION DEL TIPO DE FACTURA
,	INDFACINF	VARCHAR	(1)	--INDICADOR FACTURA INFORMATIVA (S/N)
,	FECFAC	DATE		--FECHA DE LA FACTURA
,	NUMREFFAC	VARCHAR	(23)	--NUMERO REFERENCIA FACTURA
,	PAN_OPE	VARCHAR	(22)	--PAN DE LA TARJETA QUE REALIZO LA OPERACION
,	CLAMONDIV	DECIMAL	(3,0)	--CODIGO DE MONEDA DE LA OPERACION ORIGINAL O DIVISA
,	IMPDIV	DECIMAL	(17,2)	--IMPORTE EN DIVISA ORIGINAL
,	IMPFAC	DECIMAL	(17,2)	--IMPORTE DE LA FACTURA
,	CMBAPLI	DECIMAL	(9,4)	--FACTOR DE CAMBIO APLICADO (SOLO TIENE SENTIDO PARA OPERACIONES EN EXTRANJERO)
,	CODCOM	VARCHAR	(15)	--CODIGO DE COMERCIO 
,	NOMCOMRED	VARCHAR	(27)	--NOMBRE COMERCIO REDUCIDO
,	NOMPOB	VARCHAR	(26)	--POBLACION DONDE SE REALIZO LA OPERACION
,	DESACT	VARCHAR	(30)	--DESCRIPCION DE ACTIVIDAD
,	FECPROCES	DATE		--FECHA DE PROCESO O ENTRADA DE LA OPERACION AL SISTEMA
,	CODPAIS	DECIMAL	(3,0)	--CODIGO DEL PAIS 
,	FECCONTA	DATE		--FECHA CONTABLE OPERACION
,	IMPIMPTO	DECIMAL	(17,2)	--IMPORTE DEL IMPUESTO
,	CODACT	DECIMAL	(4,0)	--CODIGO DE ACTIVIDAD
,	LINREF	DECIMAL	(8,0)	--REFERENCIA DE LINEA ASOCIADA A LA CUENTA
,	FORPAGO	DECIMAL	(2,0)	--FORMA DE PAGO
,	NUMAUT	VARCHAR	(6)	--NUMERO DE AUTORIZACION
,	TIPOFACSIST	DECIMAL	(4,0)	--TIPO DE FACTURA DEL SISTEMA
,	CODPAISO	VARCHAR	(3)	--DESCRPCION DE PAIS CON 3 POSICIONES
,	NOMBENRED	VARCHAR	(35)	--NOMBRE DE ESTAMPACION
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	IMPAMPAG_DIF	DECIMAL	(17,2)	--IMPORTE DE PAGOS AMORTIZADOS PARA COMPRAS EN CUOTAS
,	IMPAMPAG_REV	DECIMAL	(17,2)	--IMPORTE DE PAGOS AMORTIZADOS PARA REVOLVING
,	FILLER1	VARCHAR	(555)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_MZ;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_MZ  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	CODCAMP	VARCHAR	(4)	--CODIGO DE CAMPANA
,	IMPCAMPAN	DECIMAL	(17,2)	--IMPORTE DE BONIFICIACION ONLINE
,	FILLER1	VARCHAR	(917)	--
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_RI;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_RI  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	NUMSECIMP	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO IMPAGADO
,	NUMSECREC	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO ORIGINAL
,	FECALTA	DATE		--FECHA DE ALTA DEL RECIBO IMPAGADO
,	FECEMIMOV	DATE		--FECHA EMISION DEL RECIBO 
,	FECVENMOV	DATE		--FECHA DE VENCIMIENTO DEL RECIBO
,	IMPREC	DECIMAL	(17,2)	--IMPORTE DEL RECIBO IMPAGADO
,	IMPAGO	DECIMAL	(17,2)	--IMPORTE TOTAL DEL IMPAGO. (INCLUYE INTERESES Y COMISIONES DE MORA)
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO
,	FECULTAPL	DATE		--FECHA DE ULTIMA APLICACION
,	FECENVCOB	DATE		--FECHA DE ENVIO A LA APLICACION DE COBRANZAS
,	FILLER1	VARCHAR	(810)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_RL;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_RL  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMSECIMP	DECIMAL	(15,0)	--NUMERO SECUENCIA RECIBO IMPAGADO
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE
---        01 - CAPITAL	 	 		
---        02 - COMISIONES	 	 		
---        03 - INTERESES	 	 		
---        04 - IMPUESTOS	 	 		
---        05 - COMISIONES MOROSIDAD	 	 		
---        06 - INTERESES MOROSIDAD	 	 		
---        07 - IMPUESTOS MOROSIDAD	 	 		
---        08 - SEGURIDAD	 	 		
,	IMPORTE	DECIMAL	(17,2)	--IMPORTE CORRESPONDIENTE AL TIPO DE IMPORTE
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO AL TIPO DE IMPORTE
,	FILLER1	VARCHAR	(889)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_TX;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_TX  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	TIPOLIN	VARCHAR	(4)	--TIPO DE LINEA
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE
---         01-CAPITAL	 	 		
---         02 - COMISIONES	 	 		
---         03 - INTERESES	 	 		
---         04 - IMPUESTOS	 	 		
---         05 - COMISIONES MOROSIDAD	 	 		
---         06 - INTERESES MOROSIDAD	 	 		
---         07 - IMPUESTOS MOROSIDAD	 	 		
---         08- SEGUROS	 	 		
,	IMPINI	DECIMAL	(17,2)	--IMPORTE INICIAL
,	IMPFIN	DECIMAL	(17,2)	--IMPORTE FINAL
,	IMPBON	DECIMAL	(17,2)	--IMPORTE BONIFICABLE (SOLO PARA INTERESES SI SE REALIZA EL PAGO DE TODA LA DEUDA)
,	IMPAPL	DECIMAL	(17,2)	--IMPORTE APLICADO
,	IMPREC	DECIMAL	(17,2)	--IMPORTE DE RECIBO
,	IMPMIN	DECIMAL	(17,2)	--IMPORTE MINIMO
,	FILLER1	VARCHAR	(830)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_PU;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_PU  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	PTOSGANAMESANT	DECIMAL	(8,0)	--PUNTOS GANADOS MES ANTERIOR
,	PTOSCANJMESANT	DECIMAL	(8,0)	--PUNTOS CANJEADOS MES ANTERIOR
,	PTOSVENCMES	DECIMAL	(8,0)	--PUNTOS VENCIDOS EN EL MES
,	PTOSPERDMES	DECIMAL	(8,0)	--PUNTOS PERDIDOS EN EL MES
,	PTOSCANJMES	DECIMAL	(8,0)	--PUNTOS CANJEADOS EN EL MES
,	PTOSGANAMES	DECIMAL	(8,0)	--PUNTOS GANADOS EN EL MES
,	PTOSDISP	DECIMAL	(8,0)	--PUNTOS DISPONIBLES
,	PTOSPROXCAD	DECIMAL	(8,0)	--PUNTOS PROXIMOS A CADUCAR
,	TRATARPTOS	VARCHAR	(1)	--TRATAR PUNTOS. SI TIENE "S" INDICA QUE LOS PUNTOS DEL MES YA PASAN AL MES ANTERIOR.
,	PTOSALINI	DECIMAL	(8,0)	--SALDO INICIAL DE PUNTOS
,	FILLER1	VARCHAR	(871)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_CL;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_CL  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NOMBRE	VARCHAR	(40)	--NOMBRE DE CLIENTE
,	APELLIDO1	VARCHAR	(36)	--APELLIDO 1 DEL CLIENTE 
,	APELLIDO2	VARCHAR	(36)	--APELLIDO 2 DEL CLIENTE 
,	FORMAENVIO	VARCHAR	(2)	--FORMA DE ENVIO DEL EXTRACTO
--EM-EMAIL	 	 		
--CO-CORREO	 	 		
--AM-AMBOS,CORREO E EMAIL	 	 		
--NO-NO ENVIO DE EXTRACTO	 	 		
,	EMAIL	VARCHAR	(100)	--E-MAIL DEL CLIENTE
,	CODPAIS	DECIMAL	(3,0)	--CODIGO PAIS
,	NOMPAIS	VARCHAR	(20)	--NOMBRE PAIS
,	CODREGION	VARCHAR	(3)	--CODIGO REGION
,	DESREGION	VARCHAR	(20)	--NOMBRE REGION
,	CODPROV	VARCHAR	(2)	--CODIGO PROVINCIA
,	DESPROV	VARCHAR	(20)	--NOMBRE PROVINCIA
,	CIUDAD	VARCHAR	(5)	--CODIGO CIUDAD
,	DESCIUDAD	VARCHAR	(35)	--NOMBRE CIUDAD
,	CODMUNICIP	VARCHAR	(5)	--CODIGO MUNICIPIO
,	MUNICIPIO	VARCHAR	(40)	--MUNICIPIO
,	CODSECTOR	VARCHAR	(5)	--CODIGO SECTOR
,	SECTOR	VARCHAR	(40)	--SECTOR
,	CODBARRIO	VARCHAR	(5)	--CODIGO BARRIO
,	BARRIO	VARCHAR	(40)	--BARRIO
,	TIPVIA	VARCHAR	(2)	--TIPO DE VIA
,	NOMVIA	VARCHAR	(5)	--CODIGO VIA
,	DESCNOMVIA	VARCHAR	(100)	--NOMBRE DE LA VIA 
,	NUMVIA	VARCHAR	(6)	--NUMERO DEL DOMICILIO
,	ESCALERA	VARCHAR	(4)	--ESCALERA
,	PISO	VARCHAR	(4)	--PISO
,	PUERTA	VARCHAR	(4)	--PUERTA
,	MANZANA	VARCHAR	(10)	--MANZANA
,	EDIFICIO	VARCHAR	(4)	--EDIFICIO
,	KILOMETRO	VARCHAR	(7)	--KILOMETRO
,	CODPOSTAL	VARCHAR	(10)	--ZONA POSTAL
,	APTDOCORREOS	VARCHAR	(10)	--APARTADO DE CORREOS
,	ENTRECALLES1	VARCHAR	(5)	--
,	DESENTRECALLES1	VARCHAR	(100)	--ENTRE QUE CALLES VIVE 1
,	ENTRECALLES2	VARCHAR	(5)	--
,	DESENTRECALLES2	VARCHAR	(100)	--ENTRE QUE CALLES VIVE 2
,	RESTODIR	VARCHAR	(40)	--RESTO DE DIRECCION
,	NUMDOC	VARCHAR	(22)	--NUMERO DE DOCUMETO
,	APELARGO	VARCHAR	(40)	--APELLIDO DE CASADA
,	FILLER1	VARCHAR	(9)	--filler
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_ME;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_ME  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO DE CUENTA
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	IMPSERV	DECIMAL	(17,2)	--IMPORTE TOTAL CONSUMOS EN SERVICIOS
,	IMPHOSP	DECIMAL	(17,2)	--IMPORTE TOTAL CONSUMOS EN HOSPEDAJE / ALQUILERES
,	IMPINTER	DECIMAL	(17,2)	--IMPORTE TOTAL DE CONSUMOS EN INTERNET
,	IMPCOMB	DECIMAL	(17,2)	--IMPORTE TOTAL DE CONSUMOS EN CONBUSTBLE
,	IMPRESTAU	DECIMAL	(17,2)	--IMPORTE TOTAL DE CONSUMOS EN RESTAURANTES
,	IMPAVANCE	DECIMAL	(17,2)	--IMPORTE TOTAL DE CONSUMOS EN AVANCE
,	IMPOTROS	DECIMAL	(17,2)	--IMPORTE TOTAL OTROS CONSUMOS
,	IMPTOTCON	DECIMAL	(17,2)	--IMPORTE TOTAL CONSUMOS
,	FILLER	VARCHAR	(802)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_PZ;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_PZ  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	TIPIMP	DECIMAL	(2,0)	--TIPO DE IMPORTE
--01-CAPITAL	 	 		
--02 - COMISIONES	 	 		
--03 - INTERESES	 	 		
--04 - IMPUESTOS	 	 		
--05 - COMISIONES MOROSIDAD	 	 		
--06 - INTERESES MOROSIDAD	 	 		
--07 - IMPUESTOS MOROSIDAD	 	 		
--08- SEGUROS	 	 		
,	PAGAPLI	DECIMAL	(17,2)	--PAGOS APLICADOS
,	FILLER1	VARCHAR	(919)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_SZ;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_SZ  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	TIPLINEA	VARCHAR	(3)	--TIPO DE LINEA
--REV: REVOLVING.	 	 		
--INT: INTRAFINANCIAMIENTO	 	 		
-- EXT:  EXTRAFINANCIAMIENTO	 	 		
,	CAPACT	DECIMAL	(17,2)	--IMPORTE CAPITAL ACTUAL
,	INTACT	DECIMAL	(17,2)	--IMPORTE INTERES ACTUAL
,	RECACT	DECIMAL	(17,2)	--IMPORTE RECARGO ACTUAL
,	COMACT	DECIMAL	(17,2)	--IMPORTE COMISION ACTUAL
,	PAGACT	DECIMAL	(17,2)	--IMPORTE PAGOS ACTUAL
,	COREACT	DECIMAL	(17,2)	--IMPORTE DE COMPRAS Y RETIROS ACTUAL
,	CREACT	DECIMAL	(17,2)	--IMPORTE DE CREDITOS ACTUAL
,	DEBACT	DECIMAL	(17,2)	--IMPORTE DE DEBITOS ACTUAL
,	FILLER1	VARCHAR	(799)	--FILLER
); COMMIT;	 	 		
drop table IF EXISTS SAT.PCIMPEXT_RZ;  CREATE TABLE IF NOT EXISTS SAT.PCIMPEXT_RZ  ( 	IDENTIFICADOR_EJECUCION	INTEGER		--IDENTIFICADOR UNICO DE EJECUCION
,	CODENT_D	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	NSECFIC_D	DECIMAL	(10,0)	--NUMERO DE SECUENCIA DE LA CINTA
,	TIPOCINTA_D	DECIMAL	(2,0)	--TIPO DE LA CINTA
,	TIPOREG_D	VARCHAR	(1)	--TIPO DE REGISTRO D = DETALLE 
,	FILLER_D	VARCHAR	(91)	--FILLER
,	NUMREGPROC	DECIMAL	(12,0)	--NUMERO DE REGISTRO PROCESADO
,	CODENT	VARCHAR	(4)	--CODIGO DE ENTIDAD
,	CENTALTA	VARCHAR	(4)	--CENTRO DE ALTA CUENTA DE TARJETA
,	CUENTA	VARCHAR	(12)	--CUENTA DE TARJETA
,	PAN	VARCHAR	(22)	--NUMERO DE TARJETA (PRIMERA TARJETA DEL CONTRATO)
,	TIPOREG	VARCHAR	(2)	--TIPO DE REGISTRO 
--'CL' - DATOS DE CLIENTE 	 	 		
--'CU' - CUENTA O CONTRATO DE TARJETA 	 	 		
--'LI' - LINEAS DE CREDITO PARALELAS	 	 		
--'EX' - EXTRACTO 	 	 		
--'TX' - EXTRACTO - TIPO DE LINEA - TIPO IMPORTE	 	 		
--'MX' - MOVIMIENTO EXTRACTO	 	 		
--'MC' - MOVIMIENTO CONCEPTO ECONOMICO	 	 		
--'IC' - CONTRATO IMPAGADO	 	 		
--'IL' - DESGLOSE CONTRATO IMPAGADO	 	 		
--'RI' - RECIBO IMPAGADO	 	 		
--'RL' - DESGLOSE RECIBO IMPAGADO	 	 		
--'MI' - MOVIMIENTO RECIBO IMPAGADO	 	 		
--'CI' - CONCEPTO ECONOMICO DE MOVIMIENTO RECIBO       IMPAGADO	 	 		
--'PU'    - PUNTOS DE FIDELIZACION SFC O B.LEON'	 	 		
--?ML'    - LINEAS DE MENSAJERIA PARA EXTRACTOS	 	 		
--'MS'    - MANEJO DE MENSAJES PROMOCIONALES	 	 		
--'MZ'    - BONIFICACION ONLINE DE CAMPANAS	 	 		
,	NUMORDEN	DECIMAL	(12,0)	--NUMERO DE ORDEN 
,	NUMEXTCTA	DECIMAL	(3,0)	--NUMERO DE EXTRACTO
,	CLAMON	DECIMAL	(3,0)	--CLAVE DE MONEDA
,	TIPLINEA	VARCHAR	(3)	--TIPO DE LINEA
---       REV: REVOLVING.	 	 		
---       INT: INTRAFINANCIAMIENTO	 	 		
---       EXT:  EXTRAFINANCIAMIENTO	 	 		
,	CAPACT	DECIMAL	(17,2)	--IMPORTE CAPITAL ACTUAL
,	INTACT	DECIMAL	(17,2)	--IMPORTE INTERES ACTUAL
,	RECACT	DECIMAL	(17,2)	--IMPORTE RECARGO ACTUAL
,	COMACT	DECIMAL	(17,2)	--IMPORTE COMISION ACTUAL
,	PAGACT	DECIMAL	(17,2)	--IMPORTE PAGOS ACTUAL
,	CORACT	DECIMAL	(17,2)	--IMPORTE DE COMPRAS Y RETIROS ACTUAL
,	CREACT	DECIMAL	(17,2)	--IMPORTE DE CREDITOS ACTUAL
,	DEBACT	DECIMAL	(17,2)	--IMPORTE DE DEBITOS ACTUAL
,	FILLER1	VARCHAR	(799)	--FILLER
); COMMIT;	 	 		

------------------------
-- STAGE EXTRACTO DE CREDITO
-------------------------

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_CL";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_CL";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_CL";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_CL" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NOMBRE" VARCHAR(40) NULL ,
	"APELLIDO1" VARCHAR(36) NULL ,
	"APELLIDO2" VARCHAR(36) NULL ,
	"FORMAENVIO" VARCHAR(2) NULL ,
	"EMAIL" VARCHAR(100) NULL ,
	"CODPAIS" DECIMAL(3,0) NULL ,
	"NOMPAIS" VARCHAR(20) NULL ,
	"CODREGION" VARCHAR(3) NULL ,
	"DESREGION" VARCHAR(20) NULL ,
	"CODPROV" VARCHAR(2) NULL ,
	"DESPROV" VARCHAR(20) NULL ,
	"CIUDAD" VARCHAR(5) NULL ,
	"DESCIUDAD" VARCHAR(35) NULL ,
	"CODMUNICIP" VARCHAR(5) NULL ,
	"MUNICIPIO" VARCHAR(40) NULL ,
	"CODSECTOR" VARCHAR(5) NULL ,
	"SECTOR" VARCHAR(40) NULL ,
	"CODBARRIO" VARCHAR(5) NULL ,
	"BARRIO" VARCHAR(40) NULL ,
	"TIPVIA" VARCHAR(2) NULL ,
	"NOMVIA" VARCHAR(5) NULL ,
	"DESCNOMVIA" VARCHAR(100) NULL ,
	"NUMVIA" VARCHAR(6) NULL ,
	"ESCALERA" VARCHAR(4) NULL ,
	"PISO" VARCHAR(4) NULL ,
	"PUERTA" VARCHAR(4) NULL ,
	"MANZANA" VARCHAR(10) NULL ,
	"EDIFICIO" VARCHAR(4) NULL ,
	"KILOMETRO" VARCHAR(7) NULL ,
	"CODPOSTAL" VARCHAR(10) NULL ,
	"APTDOCORREOS" VARCHAR(10) NULL ,
	"ENTRECALLES1" VARCHAR(5) NULL ,
	"DESENTRECALLES1" VARCHAR(100) NULL ,
	"ENTRECALLES2" VARCHAR(5) NULL ,
	"DESENTRECALLES2" VARCHAR(100) NULL ,
	"RESTODIR" VARCHAR(40) NULL ,
	"NUMDOC" VARCHAR(22) NULL ,
	"APELARGO" VARCHAR(40) NULL ,
	"FILLER1" VARCHAR(9) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_CU";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_CU";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_CU";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_CU" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"PRODUCTO" VARCHAR(2) NULL ,
	"SUBPRODU" VARCHAR(4) NULL ,
	"CONPROD" VARCHAR(3) NULL ,
	"CALPART" VARCHAR(2) NULL ,
	"NUMBEN" DECIMAL(5,0) NULL ,
	"CODREGIMEN" DECIMAL(4,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"LIMCRECTA" DECIMAL(17,2) NULL ,
	"SALDISCRE" DECIMAL(17,2) NULL ,
	"LIMCRECTAC" DECIMAL(17,2) NULL ,
	"SALDISCREC" DECIMAL(17,2) NULL ,
	"INDMONPRIN" VARCHAR(1) NULL ,
	"CODFORMATO" VARCHAR(10) NULL ,
	"IDENTCLI" VARCHAR(8) NULL ,
	"INDDOMCARCRE" VARCHAR(1) NULL ,
	"INDCTAEMP" DECIMAL(1,0) NULL ,
	"CLASEG" VARCHAR(3) NULL ,
	"IBAN" VARCHAR(4) NULL ,
	"CTACARGO" VARCHAR(30) NULL ,
	"CODIDIOMA" VARCHAR(2) NULL ,
	"CODBLQ" DECIMAL(2,0) NULL ,
	"DISBLECRECTA" DECIMAL(17,2) NULL ,
	"DISBLECRECTAC" DECIMAL(17,2) NULL ,
	"GRUPOLIQ" DECIMAL(2,0) NULL ,
	"DESPROD" VARCHAR(30) NULL ,
	"INTERESANUAL1" DECIMAL(7,4) NULL ,
	"INTERESANUAL2" DECIMAL(7,4) NULL ,
	"BALANPAGO" DECIMAL(17,2) NULL ,
	"NOMBREMP" VARCHAR(30) NULL ,
	"GRUPOEMP" DECIMAL(4,0) NULL ,
	"PORMOPPAL" DECIMAL(7,4) NULL ,
	"TRAMOPPAL" DECIMAL(17,2) NULL ,
	"PORMOSEC" DECIMAL(7,4) NULL ,
	"TRAMOSEC" DECIMAL(17,2) NULL ,
	"INTANUALPPAL" DECIMAL(7,4) NULL ,
	"INTANUALSEC" DECIMAL(7,4) NULL ,
	"LIMCRECTAPPAL" DECIMAL(17,2) NULL ,
	"LIMCRECTASEC" DECIMAL(17,2) NULL ,
	"MOTBLQ" DECIMAL(2,0) NULL ,
	"FILLER1" VARCHAR(574) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_LI";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_LI";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_LI";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_LI" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"LINREF" DECIMAL(8,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"CODCAMCOM" VARCHAR(4) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"LIMCRELIN" DECIMAL(17,2) NULL ,
	"SALAUTLIN" DECIMAL(17,2) NULL ,
	"SALDISLIN" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(874) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_EX";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_EX";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_EX";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_EX" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"INDREP" DECIMAL(1,0) NULL ,
	"FORPAGO" DECIMAL(2,0) NULL ,
	"IMPTOTPAG" DECIMAL(17,2) NULL ,
	"IMPMIN" DECIMAL(17,2) NULL ,
	"IMPCARGO" DECIMAL(17,2) NULL ,
	"FECEXT" VARCHAR(10) NULL ,
	"FECLIQ" VARCHAR(10) NULL ,
	"FECLIQANT" VARCHAR(10) NULL ,
	"FECCAR" VARCHAR(10) NULL ,
	"FECVALCAR" VARCHAR(10) NULL ,
	"PORINT" DECIMAL(7,4) NULL ,
	"PORPAGOA" DECIMAL(7,4) NULL ,
	"IMPEXCLIM" DECIMAL(17,2) NULL ,
	"IMSALAPLPRX" DECIMAL(17,2) NULL ,
	"IMPCARGOANT" DECIMAL(17,2) NULL ,
	"NUMSECREC" DECIMAL(15,0) NULL ,
	"IMPDISBLEEXC" DECIMAL(17,2) NULL ,
	"FECVENMOV" VARCHAR(10) NULL ,
	"MX_POS" DECIMAL(17,2) NULL ,
	"MX_NEG" DECIMAL(17,2) NULL ,
	"MC_POS" DECIMAL(17,2) NULL ,
	"MC_NEG" DECIMAL(17,2) NULL ,
	"BALMESANT" DECIMAL(17,2) NULL ,
	"BALMESACT" DECIMAL(17,2) NULL ,
	"INTBONIF" DECIMAL(17,2) NULL ,
	"BALMESACTBON" DECIMAL(17,2) NULL ,
	"CUOTAMIN" DECIMAL(17,2) NULL ,
	"PLAZOMIN" DECIMAL(3,0) NULL ,
	"IMPTOTMIN" DECIMAL(17,2) NULL ,
	"CUOTA12" DECIMAL(17,2) NULL ,
	"PLAZO12" DECIMAL(3,0) NULL ,
	"IMPTOTAL12" DECIMAL(17,2) NULL ,
	"TOT_POS" DECIMAL(17,2) NULL ,
	"TOT_NEG" DECIMAL(17,2) NULL ,
	"BALPROVANT" DECIMAL(17,2) NULL ,
	"BALPROVACT" DECIMAL(17,2) NULL ,
	"IMPMINREV" DECIMAL(17,2) NULL ,
	"IMPMINCC" DECIMAL(17,2) NULL ,
	"IMPRECREV" DECIMAL(17,2) NULL ,
	"IMPRECCC" DECIMAL(17,2) NULL ,
	"IMPFINREV" DECIMAL(17,2) NULL ,
	"IMPFINCC" DECIMAL(17,2) NULL ,
	"IMPUESTO" DECIMAL(17,2) NULL ,
	"TASAEFEXT" DECIMAL(7,4) NULL ,
	"BONCAMPAN" DECIMAL(17,2) NULL ,
	"BALMESTOTANT" DECIMAL(17,2) NULL ,
	"BALMESTOTACT" DECIMAL(17,2) NULL ,
	"IMPCOM" DECIMAL(15,2) NULL ,
	"FILLER1" VARCHAR(257) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_TX";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_TX";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_TX";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_TX" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"IMPINI" DECIMAL(17,2) NULL ,
	"IMPFIN" DECIMAL(17,2) NULL ,
	"IMPBON" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"IMPREC" DECIMAL(17,2) NULL ,
	"IMPMIN" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(830) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_MX";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_MX";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_MX";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_MX" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"NUMMOVEXT" DECIMAL(7,0) NULL ,
	"INDNORCOR" DECIMAL(1,0) NULL ,
	"TIPOFAC" DECIMAL(4,0) NULL ,
	"SIGNO" VARCHAR(1) NULL ,
	"DESTIPFAC" VARCHAR(30) NULL ,
	"INDFACINF" VARCHAR(1) NULL ,
	"FECFAC" VARCHAR(10) NULL ,
	"NUMREFFAC" VARCHAR(23) NULL ,
	"PAN_OPE" VARCHAR(22) NULL ,
	"CLAMONDIV" DECIMAL(3,0) NULL ,
	"IMPDIV" DECIMAL(17,2) NULL ,
	"IMPFAC" DECIMAL(17,2) NULL ,
	"CMBAPLI" DECIMAL(9,4) NULL ,
	"CODCOM" VARCHAR(15) NULL ,
	"NOMCOMRED" VARCHAR(27) NULL ,
	"NOMPOB" VARCHAR(26) NULL ,
	"DESACT" VARCHAR(30) NULL ,
	"FECPROCES" VARCHAR(10) NULL ,
	"CODPAIS" DECIMAL(3,0) NULL ,
	"FECCONTA" VARCHAR(10) NULL ,
	"IMPIMPTO" DECIMAL(17,2) NULL ,
	"CODACT" DECIMAL(4,0) NULL ,
	"LINREF" DECIMAL(8,0) NULL ,
	"FORPAGO" DECIMAL(2,0) NULL ,
	"NUMAUT" VARCHAR(6) NULL ,
	"TIPOFACSIST" DECIMAL(4,0) NULL ,
	"CODPAISO" VARCHAR(3) NULL ,
	"NOMBENRED" VARCHAR(35) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"FILLER1" VARCHAR(589) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_MC";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_MC";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_MC";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_MC" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"NUMMOVEXT" DECIMAL(7,0) NULL ,
	"CODCONECO" DECIMAL(4,0) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"DESCONECO" VARCHAR(30) NULL ,
	"IMPAPLECO" DECIMAL(17,2) NULL ,
	"IMPBRUECO" DECIMAL(17,2) NULL ,
	"IMPBONECO" DECIMAL(17,2) NULL ,
	"IMPIMPTO" DECIMAL(17,2) NULL ,
	"SIGNO" VARCHAR(1) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"FILLER1" VARCHAR(822) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_IC";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_IC";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_IC";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_IC" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"SITUACION" DECIMAL(2,0) NULL ,
	"IMPCONT" DECIMAL(17,2) NULL ,
	"IMPAGO" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"FECULTAPL" VARCHAR(10) NULL ,
	"FECENVCOB" VARCHAR(10) NULL ,
	"NUMRECIMP" DECIMAL(2,0) NULL ,
	"FILLER1" VARCHAR(866) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_IL";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_IL";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_IL";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_IL" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"IMPORTE" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(901) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_RI";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_RI";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_RI";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_RI" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"NUMSECIMP" DECIMAL(15,0) NULL ,
	"NUMSECREC" DECIMAL(15,0) NULL ,
	"FECALTA" VARCHAR(10) NULL ,
	"FECEMIMOV" VARCHAR(10) NULL ,
	"FECVENMOV" VARCHAR(10) NULL ,
	"IMPREC" DECIMAL(17,2) NULL ,
	"IMPAGO" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"FECULTAPL" VARCHAR(10) NULL ,
	"FECENVCOB" VARCHAR(10) NULL ,
	"FILLER1" VARCHAR(810) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_RL";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_RL";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_RL";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_RL" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMSECIMP" DECIMAL(15,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"IMPORTE" DECIMAL(17,2) NULL ,
	"IMPAPL" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(889) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_MI";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_MI";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_MI";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_MI" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMSECIMP" DECIMAL(15,0) NULL ,
	"NUMMOVIMP" DECIMAL(7,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"TIPOLIN" VARCHAR(4) NULL ,
	"INDNORCOR" DECIMAL(1,0) NULL ,
	"TIPOFAC" DECIMAL(4,0) NULL ,
	"FECFAC" VARCHAR(10) NULL ,
	"IMPORTE" DECIMAL(17,2) NULL ,
	"FECPROCES" VARCHAR(10) NULL ,
	"FECCONTA" VARCHAR(10) NULL ,
	"ORIGENOPE" VARCHAR(4) NULL ,
	"TIPDOCPAG" DECIMAL(2,0) NULL ,
	"REFDOCPAG" VARCHAR(20) NULL ,
	"IMPAMORT" DECIMAL(17,2) NULL ,
	"TIPDEVOL" DECIMAL(2,0) NULL ,
	"FEC2PRES" VARCHAR(10) NULL ,
	"IMPIMPTO" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(791) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_CI";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_CI";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_CI";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_CI" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMSECIMP" DECIMAL(15,0) NULL ,
	"NUMMOVIMP" DECIMAL(7,0) NULL ,
	"CODCONECO" DECIMAL(4,0) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"IMPAPLECO" DECIMAL(17,2) NULL ,
	"IMPBRUECO" DECIMAL(17,2) NULL ,
	"IMPBONECO" DECIMAL(17,2) NULL ,
	"IMPIMPTO" DECIMAL(17,2) NULL ,
	"IMPCONSOL" DECIMAL(17,2) NULL ,
	"PORINT" DECIMAL(7,4) NULL ,
	"INDPERCON" VARCHAR(1) NULL ,
	"FILLER1" VARCHAR(823) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_ME";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_ME";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_ME";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_ME" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"IMPSERV" DECIMAL(17,2) NULL ,
	"IMPHOSP" DECIMAL(17,2) NULL ,
	"IMPINTER" DECIMAL(17,2) NULL ,
	"IMPCOMB" DECIMAL(17,2) NULL ,
	"IMPRESTAU" DECIMAL(17,2) NULL ,
	"IMPAVANCE" DECIMAL(17,2) NULL ,
	"IMPOTRCONSUMOS" DECIMAL(17,2) NULL ,
	"IMPCONSUMOS" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(802) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_PU";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_PU";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_PU";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_PU" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"PTOSGANAMESANT" DECIMAL(8,0) NULL ,
	"PTOSCANJMESANT" DECIMAL(8,0) NULL ,
	"PTOSVENCMES" DECIMAL(8,0) NULL ,
	"PTOSPERDMES" DECIMAL(8,0) NULL ,
	"PTOSCANJMES" DECIMAL(8,0) NULL ,
	"PTOSGANAMES" DECIMAL(8,0) NULL ,
	"PTOSDISP" DECIMAL(8,0) NULL ,
	"PTOSPROXCAD" DECIMAL(8,0) NULL ,
	"TRATARPTOS" VARCHAR(1) NULL ,
	"PTOSALINI" DECIMAL(8,0) NULL ,
	"FILLER1" VARCHAR(871) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_ML";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_ML";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_ML";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_ML" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"LINEA1" VARCHAR(50) NULL ,
	"FILLER1" VARCHAR(894) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_MS";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_MS";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_MS";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_MS" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"TIPCASILLA" VARCHAR(1) NULL ,
	"TIPOMSG" VARCHAR(1) NULL ,
	"MENSAJE" VARCHAR(500) NULL ,
	"FILLER1" VARCHAR(442) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_MZ";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_MZ";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_MZ";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_MZ" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"CODCAMP" VARCHAR(4) NULL ,
	"IMPCAMPAN" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(917) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_PZ";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_PZ";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_PZ";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_PZ" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"TIPIMP" DECIMAL(2,0) NULL ,
	"PAGAPLI" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(919) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_RZ";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_RZ";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_RZ";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_RZ" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"TIPLINEA" VARCHAR(3) NULL ,
	"CAPACT" DECIMAL(17,2) NULL ,
	"INTACT" DECIMAL(17,2) NULL ,
	"RECACT" DECIMAL(17,2) NULL ,
	"COMACT" DECIMAL(17,2) NULL ,
	"PAGACT" DECIMAL(17,2) NULL ,
	"CORACT" DECIMAL(17,2) NULL ,
	"CREACT" DECIMAL(17,2) NULL ,
	"DEBACT" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(799) NULL 
)  COMMIT;

DROP TABLE IF EXISTS "DWH_ETLS"."PCIMPEXT_SZ";
COMMIT;
DROP TABLE IF EXISTS "STG"."PCIMPEXT_SZ";
COMMIT;
DROP TABLE IF EXISTS "STG_SAT"."PCIMPEXT_SZ";
COMMIT;
CREATE TABLE IF NOT EXISTS "STG_SAT"."PCIMPEXT_SZ" (
	"CODENT_D" VARCHAR(4) NULL ,
	"NSECFIC_D" DECIMAL(10,0) NULL ,
	"TIPOCINTA_D" DECIMAL(2,0) NULL ,
	"TIPOREG_D" VARCHAR(1) NULL ,
	"FILLER_D" VARCHAR(91) NULL ,
	"NUMREGPROC" DECIMAL(12,0) NULL ,
	"CODENT" VARCHAR(4) NULL ,
	"CENTALTA" VARCHAR(4) NULL ,
	"CUENTA" VARCHAR(12) NULL ,
	"PAN" VARCHAR(22) NULL ,
	"TIPOREG" VARCHAR(2) NULL ,
	"NUMORDEN" DECIMAL(12,0) NULL ,
	"NUMEXTCTA" DECIMAL(3,0) NULL ,
	"CLAMON" DECIMAL(3,0) NULL ,
	"TIPLINEA" VARCHAR(3) NULL ,
	"CAPMIN" DECIMAL(17,2) NULL ,
	"INTMIN" DECIMAL(17,2) NULL ,
	"RECMIN" DECIMAL(17,2) NULL ,
	"COMMIN" DECIMAL(17,2) NULL ,
	"IMPMORA" DECIMAL(17,2) NULL ,
	"FILLER1" VARCHAR(850) NULL 
)  COMMIT;

------------------------------------------------
---- CONTROL DE VERSION ------------------------
------------------------------------------------
create table IF NOT EXISTS CNF.VERSION_OBJETOS (
 NOMBRE_MALLA varchar(100)
,OBJECT_NAME varchar(100)
,OBJECT_USER varchar(20)
,VERSION_COMMIT VARCHAR(100)
,VERSION_CODE VARCHAR(20)
,VERSION_DATE DATETIME
,CRDATE DATETIME null default getdate()
,CRUSER varchar(20) null default user_name()
)
;
COMMIT;

declare 
 @NOMBRE_MALLA varchar(100)
,@OBJECT_NAME varchar(100)
,@OBJECT_USER varchar(20)
,@VERSION_COMMIT VARCHAR(100)
,@VERSION_CODE VARCHAR(20)
,@VERSION_DATE DATETIME 
,@CRDATE DATETIME

select 
 @NOMBRE_MALLA = 'MPJ51151'
,@OBJECT_NAME = 'PCIMPEXT_CI'
,@OBJECT_USER = 'SAT'
,@VERSION_COMMIT = 'f0e40d208599d1ca3c1f317fee2205f331490c20'
,@VERSION_CODE = 'f0e40d2'
,@VERSION_DATE = ' 2019/01/28 4:16:42 PM'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_CU'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_EX'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_IC'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_IL'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_LI'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MC'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MI'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_ML'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MS'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MX'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MZ'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_RI'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_RL'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_TX'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_PU'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_CL'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_ME'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_PZ'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_SZ'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_RZ'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_CI'
,@OBJECT_USER = 'STG_SAT'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_CU'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_EX'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_IC'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_IL'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_LI'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MC'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MI'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_ML'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MS'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MX'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_MZ'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_RI'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_RL'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_TX'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_PU'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_CL'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_ME'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_PZ'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_SZ'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

select 
 @OBJECT_NAME = 'PCIMPEXT_RZ'
,@CRDATE = NULL

SELECT @CRDATE = create_time 
FROM SYSUSERS U, SYSTABLE T, SYSIQTABLE S
where T.table_name = @OBJECT_NAME
  and T.creator = U.uid
  and U.name = @OBJECT_USER
  and T.table_id = S.table_id
if @CRDATE IS NULL SELECT @CRDATE = getdate()

IF EXISTS(SELECT 1 from CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE)
  DELETE CNF.VERSION_OBJETOS where OBJECT_NAME = @OBJECT_NAME AND OBJECT_USER = @OBJECT_USER AND VERSION_CODE = @VERSION_CODE
insert CNF.VERSION_OBJETOS (
 NOMBRE_MALLA, OBJECT_NAME ,OBJECT_USER ,VERSION_COMMIT ,VERSION_CODE ,VERSION_DATE ,CRDATE
)
select 
 @NOMBRE_MALLA, @OBJECT_NAME ,@OBJECT_USER ,@VERSION_COMMIT,@VERSION_CODE ,@VERSION_DATE ,@CRDATE 

COMMIT;